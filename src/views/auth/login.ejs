<!DOCTYPE html>
<html lang="<%= locale || 'en' %>" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= __('login.title') %> - BookNotes</title>
    <link rel="stylesheet" href="/css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>(function(){var s=localStorage.getItem('booknotes-theme');if(s==='dark'){document.documentElement.setAttribute('data-theme','dark')}else{document.documentElement.setAttribute('data-theme','light')}})()</script>
</head>
<body>
    <div class="auth-split">
        <!-- LEFT: Login Illustration -->
        <div class="auth-illustration auth-illust-login">
            <div class="float-shape login-fs-1"></div>
            <div class="float-shape login-fs-2"></div>
            <div class="float-shape login-fs-3"></div>
            <div class="float-shape login-fs-4"></div>

            <a href="/" class="illust-brand">
                <div class="illust-brand-icon"><i class="fas fa-book-open"></i></div>
                <span class="illust-brand-text">BookNotes</span>
            </a>

            <div class="illust-visual">
                <!-- Cartoon: Person reading on cozy armchair -->
                <svg viewBox="0 0 400 360" fill="none" xmlns="http://www.w3.org/2000/svg" class="illust-svg">
                    <!-- Floor shadow -->
                    <ellipse cx="200" cy="340" rx="160" ry="14" fill="rgba(0,0,0,0.1)"/>

                    <!-- Bookshelf background -->
                    <rect x="260" y="60" width="100" height="200" rx="6" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.12)" stroke-width="2"/>
                    <rect x="268" y="72" width="24" height="36" rx="3" fill="#FF6B6B" opacity="0.7"/>
                    <rect x="296" y="76" width="18" height="32" rx="3" fill="#FFC947" opacity="0.7"/>
                    <rect x="318" y="70" width="20" height="38" rx="3" fill="#00C9A7" opacity="0.6"/>
                    <rect x="342" y="74" width="12" height="34" rx="2" fill="#A29BFE" opacity="0.7"/>
                    <line x1="264" y1="116" x2="356" y2="116" stroke="rgba(255,255,255,0.1)" stroke-width="2"/>
                    <rect x="270" y="124" width="20" height="30" rx="3" fill="#74B9FF" opacity="0.6"/>
                    <rect x="294" y="128" width="22" height="26" rx="3" fill="#FF85A2" opacity="0.6"/>
                    <rect x="320" y="122" width="16" height="32" rx="2" fill="#FFC947" opacity="0.5"/>
                    <line x1="264" y1="162" x2="356" y2="162" stroke="rgba(255,255,255,0.1)" stroke-width="2"/>
                    <rect x="268" y="170" width="28" height="20" rx="3" fill="rgba(255,255,255,0.12)"/>
                    <rect x="300" y="168" width="22" height="22" rx="3" fill="rgba(255,255,255,0.08)"/>
                    <circle cx="340" cy="180" r="10" fill="rgba(255,255,255,0.1)"/>

                    <!-- Floor lamp -->
                    <rect x="52" y="120" width="6" height="200" rx="3" fill="rgba(255,255,255,0.15)"/>
                    <ellipse cx="55" cy="320" rx="18" ry="5" fill="rgba(255,255,255,0.1)"/>
                    <path d="M30 120 L55 90 L80 120 Z" fill="#FFC947" opacity="0.8"/>
                    <ellipse cx="55" cy="85" rx="12" ry="12" fill="#FFC947" opacity="0.3">
                        <animate attributeName="opacity" values="0.2;0.4;0.2" dur="3s" repeatCount="indefinite"/>
                    </ellipse>

                    <!-- Cozy armchair -->
                    <path d="M100 220 C100 180, 120 160, 160 160 L240 160 C280 160, 300 180, 300 220 L300 300 C300 310, 295 315, 285 315 L115 315 C105 315, 100 310, 100 300 Z" fill="rgba(255,255,255,0.12)" stroke="rgba(255,255,255,0.18)" stroke-width="2"/>
                    <!-- Armrests -->
                    <path d="M85 200 C80 200, 75 210, 75 225 L75 285 C75 295, 80 300, 90 300 L100 300 L100 200 Z" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.15)" stroke-width="1.5"/>
                    <path d="M315 200 C320 200, 325 210, 325 225 L325 285 C325 295, 320 300, 310 300 L300 300 L300 200 Z" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.15)" stroke-width="1.5"/>
                    <!-- Cushion -->
                    <ellipse cx="200" cy="260" rx="80" ry="25" fill="rgba(255,255,255,0.06)"/>

                    <!-- Person sitting - body -->
                    <path d="M170 180 C170 175, 175 170, 180 168 L220 168 C225 170, 230 175, 230 180 L235 250 L165 250 Z" fill="#A29BFE" opacity="0.9"/>
                    <!-- Neck -->
                    <rect x="192" y="138" width="16" height="32" rx="8" fill="#FDBCB4"/>
                    <!-- Head -->
                    <circle cx="200" cy="125" r="28" fill="#FDBCB4"/>
                    <!-- Hair -->
                    <path d="M172 118 C172 95, 185 82, 200 82 C215 82, 228 95, 228 118 C228 108, 220 100, 200 100 C180 100, 172 108, 172 118 Z" fill="#5D4037"/>
                    <!-- Eyes -->
                    <circle cx="190" cy="122" r="3" fill="#333"/>
                    <circle cx="210" cy="122" r="3" fill="#333"/>
                    <!-- Smile -->
                    <path d="M193 132 Q200 138 207 132" stroke="#E8967A" stroke-width="2" fill="none" stroke-linecap="round"/>
                    <!-- Glasses -->
                    <circle cx="190" cy="122" r="8" stroke="rgba(255,255,255,0.5)" stroke-width="1.5" fill="none"/>
                    <circle cx="210" cy="122" r="8" stroke="rgba(255,255,255,0.5)" stroke-width="1.5" fill="none"/>
                    <line x1="198" y1="122" x2="202" y2="122" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>

                    <!-- Arms holding book -->
                    <path d="M170 195 L140 220 L145 240 L175 225" fill="#FDBCB4" opacity="0.9"/>
                    <path d="M230 195 L260 220 L255 240 L225 225" fill="#FDBCB4" opacity="0.9"/>

                    <!-- Open book in hands -->
                    <rect x="140" y="215" width="55" height="40" rx="2" fill="#fff" opacity="0.9" transform="rotate(-5 167 235)"/>
                    <rect x="200" y="215" width="55" height="40" rx="2" fill="#F0F0F5" opacity="0.9" transform="rotate(5 227 235)"/>
                    <line x1="148" y1="225" x2="185" y2="223" stroke="#ddd" stroke-width="1.5"/>
                    <line x1="148" y1="232" x2="180" y2="230" stroke="#ddd" stroke-width="1.5"/>
                    <line x1="148" y1="239" x2="175" y2="237" stroke="#ddd" stroke-width="1.5"/>
                    <line x1="210" y1="223" x2="247" y2="225" stroke="#ddd" stroke-width="1.5"/>
                    <line x1="210" y1="230" x2="242" y2="232" stroke="#ddd" stroke-width="1.5"/>

                    <!-- Legs -->
                    <rect x="170" y="250" width="25" height="50" rx="8" fill="#4A69BD" opacity="0.8"/>
                    <rect x="205" y="250" width="25" height="50" rx="8" fill="#4A69BD" opacity="0.8"/>
                    <!-- Shoes -->
                    <ellipse cx="180" cy="302" rx="18" ry="8" fill="#333" opacity="0.7"/>
                    <ellipse cx="220" cy="302" rx="18" ry="8" fill="#333" opacity="0.7"/>

                    <!-- Coffee mug on floor -->
                    <rect x="310" y="296" width="22" height="18" rx="4" fill="#FF6B6B" opacity="0.8"/>
                    <path d="M332 300 Q340 304 332 312" stroke="#FF6B6B" stroke-width="2.5" fill="none" opacity="0.6"/>
                    <!-- Steam -->
                    <path d="M316 292 Q318 282 320 292" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" fill="none">
                        <animate attributeName="d" values="M316 292 Q318 282 320 292;M316 290 Q319 278 322 290;M316 292 Q318 282 320 292" dur="2s" repeatCount="indefinite"/>
                    </path>
                    <path d="M322 290 Q324 280 326 290" stroke="rgba(255,255,255,0.25)" stroke-width="1.5" fill="none">
                        <animate attributeName="d" values="M322 290 Q324 280 326 290;M322 288 Q325 276 328 288;M322 290 Q324 280 326 290" dur="2.5s" repeatCount="indefinite"/>
                    </path>

                    <!-- Cat sleeping near chair -->
                    <ellipse cx="110" cy="310" rx="22" ry="12" fill="rgba(255,255,255,0.15)"/>
                    <circle cx="96" cy="304" r="8" fill="rgba(255,255,255,0.15)"/>
                    <path d="M90 298 L88 290 L94 296" fill="rgba(255,255,255,0.15)"/>
                    <path d="M100 298 L102 290 L96 296" fill="rgba(255,255,255,0.15)"/>
                    <ellipse cx="130" cy="308" rx="10" ry="4" fill="rgba(255,255,255,0.1)" transform="rotate(20 130 308)"/>

                    <!-- Floating decorative elements -->
                    <circle cx="50" cy="60" r="6" fill="#FFC947" opacity="0.5">
                        <animate attributeName="cy" values="60;50;60" dur="4s" repeatCount="indefinite"/>
                    </circle>
                    <path d="M340 50 L344 58 L352 58 L346 64 L348 72 L340 68 L332 72 L334 64 L328 58 L336 58 Z" fill="#FFC947" opacity="0.4">
                        <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3s" repeatCount="indefinite"/>
                    </path>
                    <circle cx="80" cy="90" r="4" fill="#FF85A2" opacity="0.4">
                        <animate attributeName="cy" values="90;82;90" dur="3.5s" repeatCount="indefinite"/>
                    </circle>
                    <!-- Heart -->
                    <path d="M55 160 C55 155, 62 150, 62 155 C62 150, 69 155, 69 160 C69 168, 62 174, 62 174 C62 174, 55 168, 55 160 Z" fill="#FF6B6B" opacity="0.35">
                        <animate attributeName="opacity" values="0.25;0.45;0.25" dur="2.5s" repeatCount="indefinite"/>
                    </path>
                </svg>
            </div>

            <div class="auth-illust-content">
                <h2><%= __('login.illustTitle') %></h2>
                <p><%= __('login.illustDesc') %></p>
            </div>
        </div>

        <!-- RIGHT: Form -->
        <div class="auth-form-panel">
            <div class="auth-form-actions">
                <div class="auth-lang">
                    <a href="/language/en?returnTo=/auth/login" class="<%= locale === 'en' ? 'active' : '' %>">EN</a>
                    <a href="/language/tr?returnTo=/auth/login" class="<%= locale === 'tr' ? 'active' : '' %>">TR</a>
                </div>
                <button type="button" class="auth-icon-btn" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
            </div>

            <div class="auth-form-header">
                <a href="/" class="back-link"><i class="fas fa-arrow-left"></i> <%= __('login.backToHome') %></a>
                <h1><%= __('login.title') %></h1>
                <p><%= __('login.subtitle') %></p>
            </div>

            <% if (success && success.length > 0) { %>
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i> <%= success %>
                </div>
            <% } %>
            <% if (error && error.length > 0) { %>
                <div class="alert alert-error">
                    <i class="fas fa-exclamation-circle"></i> <%= error %>
                </div>
            <% } %>

            <form action="/auth/login" method="POST" class="auth-form" id="loginForm">
                <div class="form-group">
                    <label for="identifier" class="form-label"><%= __('login.email') %></label>
                    <div class="input-wrap">
                        <input type="text" id="identifier" name="identifier" class="form-control"
                            placeholder="<%= __('login.emailPlaceholder') %>" required autofocus>
                    </div>
                </div>
                <div class="form-group">
                    <label for="password" class="form-label"><%= __('login.password') %></label>
                    <div class="input-wrap pw-wrap">
                        <input type="password" id="password" name="password" class="form-control"
                            placeholder="<%= __('login.passwordPlaceholder') %>" required>
                        <button type="button" class="pw-toggle" id="pwToggle" aria-label="<%= __('login.showPassword') %>">
                            <i class="fas fa-eye" id="pwIcon"></i>
                        </button>
                    </div>
                </div>
                <button type="submit" class="auth-btn" id="submitBtn">
                    <span id="btnText"><%= __('login.button') %></span> <i class="fas fa-arrow-right"></i>
                </button>
            </form>

            <div class="auth-form-footer">
                <%= __('login.noAccount') %> <a href="/auth/register"><%= __('login.registerLink') %></a>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded',function(){
            var b=document.getElementById('themeToggle'),i=document.getElementById('themeIcon');
            function s(){i.className=document.documentElement.getAttribute('data-theme')==='dark'?'fas fa-sun':'fas fa-moon'}
            s();
            b.addEventListener('click',function(){
                var d=document.documentElement.getAttribute('data-theme')==='dark',n=d?'light':'dark';
                document.documentElement.setAttribute('data-theme',n);localStorage.setItem('booknotes-theme',n);s();
            });
            var pwBtn=document.getElementById('pwToggle'),pwField=document.getElementById('password'),pwIc=document.getElementById('pwIcon');
            if(pwBtn)pwBtn.addEventListener('click',function(){var h=pwField.type==='password';pwField.type=h?'text':'password';pwIc.className=h?'fas fa-eye-slash':'fas fa-eye'});
            var form=document.getElementById('loginForm'),btn=document.getElementById('submitBtn'),btnText=document.getElementById('btnText');
            if(form)form.addEventListener('submit',function(){btn.disabled=true;btn.style.opacity='0.7';btnText.textContent='...'});
        });
    </script>
</body>
</html>
